# 쿠버네티스 리소스의 관리와 설정

## 1. 네임스페이스(Namespace) : 리소스를 논리적으로 구분하는 장벽
- 도커나 도커 스웜 모드를 사용할 때에는 컨테이너를 논리적으로 구분하는 방법이 없다.
- 쿠버네티스에서는 리소스를 논리적으로 구분하기 위해 네임스페이스(Namespace)라는 오브젝트를 제공한다.
  - 네임스페이스는 포드, 레플리카셋, 디플로이먼트, 서비스 등과 같은 쿠버네티스 리소스들이 묶여 있는 하나의 가상 공간 또는 그룹이다.
- 여러 개의 네임스페이스를 사용하면 하나의 클러스터에서 여러 개의 가상 클러스터를 동시에 사용하는 것처럼 느껴진다.

### 1.1. 네임스페이스 기본 개념 이해
- `kubectl get namespaces` 명령어로 네임스페이스의 목록을 확인할 수 있다.
  - namespaces는 namespace나 ns로 줄일 수 있다.
- `kubectl get [리소스] --namespace [네임스페이스 이름]` 명령어로 해당 네임스페이스의 해당 리소스를 확인할 수 있다.
  - **--namespace** 옵션은 **-n**으로 줄일 수 있다.
- **--namespace** 옵션을 명시하지 않으면 기본적으로 **default** 네임스페이스를 사용한다.
- 각 네임스페이스의 리소스들은 물리적으로는 격리된 것이 아니다.
  - 서로 다른 네임스페이스에서 생성된 포드가 같은 노드에 존재할 수도 있다.

### 1.2. 네임스페이스 사용하기
1. YAML 파일을 작성한다.
```yaml
apiVersion: v1
kind: Namespace
metadata:
  name: production
```
2. `kubectl apply -f [YAML 파일]` 또는 `kubectl create namespace [네임스페이스 이름]` 명령어로 네임스페이스를 생성할 수 있다.
3. 특정 네임스페이스에 리소스를 생성한다.
   - 생성한 네임스페이스에 특정 리소스를 사용하려면, 리소스의 YAML 파일의 **metadata.namespace** 항목을 네임스페이스의 이름으로 설정한다.
   - `kubectl get [리소스] --all-namespaces` 명령어로 모든 네임스페이스의 해당 리소스를 확인할 수 있다.

### 1.3. 네임스페이스의 서비스에 접근하기
- 같은 네임스페이스 내의 서비스에 접근할 때에는 서비스 이름만으로 접근할 수 있다.
  - 즉, 다른 네임스페이스에 존재하는 서비스에는 서비스 이름만으로 접근할 수 없다.
  - `[서비스 이름].[네임스페이스 이름].svc`처럼 서비스 이름 뒤에 네임스페이스 이름을 붙이면 다른 네임스페이스의 서비스에도 접근할 수 있다.
- 네임스페이스는 `kubectl delete -f [YAML 파일 이름]` 또는 `kubectl delete namespace [네임스페이스 이름]` 명령어로 삭제할 수 있다.
  - 네임스페이스에 존재하는 모드 리소스가 함께 삭제된다.

### 1.4. 네임스페이스에 종속되는 쿠버네티스 오브젝트와 독립적인 오브젝트
- 모든 리소스가 네임스페이스에 의해 구분되는 것은 아니다.
  - 예를 들어, 노드(nodes)는 네임스페이스에 속하지 않는 오브젝트이다.
  - 클러스터의 관리를 위한 저수준의 오브젝트들은 네임스페이스에 속하지 않는다.
- 네임스페이스에 속하는 오브젝트의 종류는 `kubectl api-resources --namespaced=true` 명령어로 확인할 수 있다.
- 네임스페이스에 속하지 않는 오브젝트의 종류는 `kubectl api-resources --namespaced=false` 명령어로 확인할 수 있다.